<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sprite animation</title>
    <style>
        .my-canvas {
            border: 2px solid;
            background: black;
            margin: 50px;
            background: url(./images/bg.jpg);
            background-repeat: no-repeat;
            background-size: cover;
        }
    </style>
    <script src="./js/jquery-3.5.1.min.js"></script>
</head>

<body>
    <canvas class="my-canvas"></canvas>
    <script>
        var canvas = document.querySelector('.my-canvas')
        var ctx = canvas.getContext('2d')
        canvas.width = 934 / 2
        canvas.height = 641 / 2
        var arrayObject = {
            walk: []
        }
        var counter = 0
        $.get('./walk.json').then((response) => {
            var paths = response
            paths.forEach((itm, idx, data) => {
                let image = new Image()
                image.src = itm.path
                arrayObject.walk.push(image)
                image.onload = function () {
                    counter++
                    if (counter == data.length - 1) {
                        startWalk()

                    }

                }


            })
        })
        let animCounter = 0
        let animX = -100
        function startWalk() {
            let walkCnclr = setInterval(() => {
                console.log('walking')
                ctx.clearRect(0, 0, 934, 641)
                animX += 5
                ctx.drawImage(arrayObject.walk[animCounter++], animX, 160, 934 / 4, 641 / 4)
                if (animCounter >= arrayObject.walk.length) {
                    animCounter = 0

                }
                if(animX>934/2){
                    clearInterval(walkCnclr)
                    animX = -100
                }
            }, 1000 / 8)

        }

    </script>
</body>

</html>